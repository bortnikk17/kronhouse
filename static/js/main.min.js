"use strict";

(function ($) {
  $(document).ready(function () {
    svg4everybody({});
  });
})(jQuery);

window.addEventListener("load", function () {
  var body = this.document.querySelector("body");
  var html = this.document.querySelector("html"); // header

  var headerMenu = document.querySelector(".header__menu");
  var burgerBtn = document.querySelector(".header__burger");
  var closeHeader = document.querySelector(".header-menu__close");

  if (headerMenu) {
    var closeMenuFunc = function closeMenuFunc() {
      headerMenu.classList.remove("active");
      body.classList.remove("lock");
      html.classList.remove("lock");
    };

    burgerBtn && burgerBtn.addEventListener("click", function () {
      headerMenu.classList.add("active");
      body.classList.add("lock");
      html.classList.add("lock");
    });
    closeHeader && closeHeader.addEventListener("click", closeMenuFunc);
    window.addEventListener("resize", function () {
      if (window.innerWidth >= 1024 && headerMenu.classList.contains("active")) {
        closeMenuFunc();
      }
    }); // anchor links

    var anchorLinks = document.querySelectorAll(".anchor-trigger");
    var anchorBlocks = document.querySelectorAll(".anchor-block");

    if (anchorLinks) {
      anchorLinks.forEach(function (item) {
        item.addEventListener("click", function (e) {
          e.preventDefault();

          if (anchorBlocks) {
            anchorBlocks.forEach(function (block) {
              if (block.getAttribute("data-target") == item.getAttribute("data-target")) {
                var topPos = block.offsetTop;

                if (window.innerWidth <= 1024) {
                  closeMenuFunc();
                  document.documentElement.scrollTop = topPos - 80;
                } else {
                  document.documentElement.scrollTop = topPos - 160;
                }
              }
            });
          }
        });
      });
    } //anchor links end

  }

  var header = this.document.querySelector(".header--wrap");

  if (header) {
    var scrollFunc = function scrollFunc() {
      if (window.scrollY > 0) {
        header.classList.add("active");
      } else {
        header.classList.remove("active");
      }
    };

    window.addEventListener("scroll", function () {
      scrollFunc();
    });
    scrollFunc();
  } //header end
  // room slider


  var swiper = new Swiper(".room .swiper-container", {
    navigation: {
      nextEl: ".room .swiper-container .swiper-button-nextt",
      prevEl: ".room .swiper-container .swiper-button-prevv"
    },
    slidesPerView: 1,
    breakpoints: {
      2501: {
        slidesPerView: 3
      },
      1800: {
        slidesPerView: 2
      },
      1201: {
        slidesPerView: 1
      },
      701: {
        slidesPerView: 2
      },
      571: {
        slidesPerView: 1.5
      }
    }
  }); // room slider end
  // checkboxes

  var checkboxes = document.querySelectorAll(".check");

  if (checkboxes) {
    checkboxes.forEach(function (check) {
      check.addEventListener("change", function () {
        var parent = check.closest(".form-checkbox");

        if (check.checked) {
          parent.classList.remove("error");
          parent.classList.add("active");
        } else {
          parent.classList.remove("active");
        }
      });
    });
  } // checkboxes end
  //validate


  var forms = document.querySelectorAll(".form-container");
  var mailForm = document.querySelector(".mail-form");
  forms && forms.forEach(function (item) {
    item.addEventListener('submit', function (e) {
      e.preventDefault();
      var valide = true;
      var inputs = item.querySelectorAll('.form-required');
      var checkbox = item.querySelector(".form-checkbox input");
      var checkboxParent = item.querySelector(".form-checkbox");

      if (checkbox) {
        valide = false;

        if (checkboxParent.classList.contains("active")) {
          valide = true;
        } else {
          checkboxParent.classList.add("error");
          valide = false;
        }
      }

      inputs.forEach(function (element) {
        // let radio=item.querySelector(".radio__parent")
        // if(radio && !radio.classList.contains("checked")){
        //   valide=false
        //   radio.classList.add("error")
        // }
        var parent = element.closest('.form-item');
        var form = element.closest(".folow__form");

        if (element.value.trim() === '') {
          parent.classList.add('error');

          if (parent.classList.contains("error-company")) {
            parent.classList.remove("error");
          }

          if (form) {
            form.classList.add("error");
          }

          valide = false;
        } else {
          parent.classList.remove('error');

          if (form) {
            form.classList.remove("error");
          }
        }
      });

      if (valide) {
        fetch('https://jsonplaceholder.typicode.com/posts', {
          method: 'POST',
          body: new FormData(item)
        }).then(function (response) {
          if (response.ok) {
            return response.json();
          }

          return Promise.reject(response);
        }).then(function (data) {})["catch"](function (error) {
          console.warn(error);
        });

        if (item.classList.contains("modal-call__container")) {
          var _modalCall = document.querySelector(".modal-call");

          var thanksModal = document.querySelector(".modal-thanks");

          if (_modalCall && thanksModal) {
            _modalCall.classList.remove("active");

            setTimeout(function () {
              thanksModal.classList.add("active");
            }, 150);
          }

          if (thanksModal) {
            window.addEventListener("click", function (e) {
              if (e.target == thanksModal) {
                body.classList.remove("lock");
                html.classList.remove("lock");
                thanksModal.classList.remove("active");
              }
            });
            var backBtn = thanksModal.querySelector(".modal-thanks-submit");
            backBtn && backBtn.addEventListener("click", function () {
              body.classList.remove("lock");
              html.classList.remove("lock");
              thanksModal.classList.remove("active");
            });
          }
        }

        inputs.forEach(function (element) {
          element.value = "";
        });
      }
    });
  });
  var inputs = document.querySelectorAll('.form-item');

  var _loop = function _loop(i) {
    inputs[i].addEventListener("input", function () {
      var form = inputs[i].closest(".folow__form");

      if (form) {
        form.classList.remove("error");
      }

      inputs[i].classList.remove("error");
    });
  };

  for (var i = 0; i < inputs.length; i++) {
    _loop(i);
  } // validate end
  // imask


  var inputsNumber = this.document.querySelectorAll(".number-input");

  if (inputsNumber) {
    inputsNumber.forEach(function (number) {
      var phoneMask = IMask(number, {
        mask: '+{7}(000)000-00-00'
      });
    });
  } // imask end
  // modal call


  var modalCall = document.querySelector(".modal-call");
  var triggerdModalCall = document.querySelectorAll(".call-trigger");

  if (triggerdModalCall && modalCall) {
    var closeCall = function closeCall() {
      modalCall.classList.remove("active");
      body.classList.remove("lock");
      body.classList.remove("html");
    };

    triggerdModalCall.forEach(function (trig) {
      trig.addEventListener("click", function () {
        modalCall.classList.add("active");
        body.classList.add("lock");
        body.classList.add("html");
      });
    });
    var closeModal = modalCall.querySelector(".modal__close");
    closeModal && closeModal.addEventListener("click", closeCall);
    window.addEventListener("click", function (e) {
      if (e.target == modalCall) {
        closeCall();
      }
    });
  } //modal call end

});